<!--

`<xenon-date>` provides a simple date output. Simply bind your UTC timestamp to components attribute "value".
Example:

           `<xenon-date value="2017-08-20 21:11:35.537000"></xenon-date>
            <xenon-date value="{{utcTimeStamp}}"></xenon-date>
            <xenon-date show-time value="2017-03-20 21:11:35.537000"></xenon-date>
            <xenon-date label="Start Date" show-time value="2017-03-20 21:11:35.537000"></xenon-date>`

@group Xenon Elements
@element xenon-date
@demo demo/index.html
-->

<link rel="import" href="../polymer/polymer.html" />
<dom-module id="xenon-date">
    <template>
        <content id="content"></content>
    </template>
    <script>
        Polymer({
            is: "xenon-date",
            properties: {
                value: { type: Date, observer: "_valueChange" },
                date: { type: String, notify: true },
                time: { type: String, notify: true },
                showTime: { type: Boolean, notify: true, value: false },
                showUtc: { type:Boolean, value:false }
            },
            _valueChange: function(datval) {
                // wipe out my content 
                var children = Polymer.dom(this).childNodes;
                for(var i = 0; i < children.length; i++) {
                    Polymer.dom(this).removeChild(children[i]);
                }
                var val = new Date(datval);
                // check to see if the Date is valid
                if (isNaN(val.getTime()) ) return; 
                this._dateChange(val);
                var output = (this.showTime) ? this.date + " " + this.time : this.date;
                // repopulate my content node
                var node = document.createTextNode(output);
                Polymer.dom(this).appendChild(node);
            },
            _dateChange: function (val) {
                var parts = (this.showUtc) ? this._getUtcParts(val) : this._getLocalParts(val);
                parts.ampm = parts.hours >= 12 ? 'pm' : 'am';
                parts.hours = parts.hours % 12;
                if (parts.hours == 0) parts.hours = 12;
                this.date = this._pad(parts.month) + "-" + this._pad(parts.day) + "-" + parts.year;
                this.time = this._pad(parts.hours) + ":" + this._pad(parts.minutes) + " " + parts.ampm;
            },
            _pad: function(value) {
                return (value.toString().length == 2) ? value.toString() : "0" + value.toString(); 
            },
            _getLocalParts: function (value) {
                return {
                    year: value.getFullYear(),
                    month: value.getMonth() + 1,
                    day: value.getDate(),
                    hours: value.getHours(),
                    minutes: value.getMinutes()
                };
            },
            _getUtcParts: function (value) {
                return {
                    year: value.getUTCFullYear(),
                    month: value.getUTCMonth() + 1,
                    day: value.getUTCDate(),
                    hours: value.getUTCHours(),
                    minutes: value.getUTCMinutes()
                };
            }
        });
    </script>
</dom-module>
